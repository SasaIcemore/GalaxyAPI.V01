
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>APIList</title>
</head>
<body>
    <div class="container" style="width:98%">
        <table class="table table-striped" id="api_list_table">
            <tr>
                <th>代码</th>
                <th>名称</th>
                <th>分组</th>
                <th>描述</th>
                <th>详情</th>
            </tr>
        </table> 
    </div>
    <script type="text/javascript" src="~/lib/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript">
        $(function () { 
            //生成api列表
            $.ajax({
                url: "/Index/GetApiList",
                type: "post",
                cache: false,
                success: function (data) {
                    var table = $("#api_list_table");
                    getDataTbl(data, table);
                }
            });
        });
        function getDataTbl(jsonStr, table) { 
            var jsonObj = eval("(" + jsonStr + ")");
            if (jsonObj != null) {
                for (var i = 0; i < jsonObj.length;i++) { 
                    var tr = $("<tr></tr>");
                    tr.appendTo(table);

                    var api_code = $("<td></td>");
                    api_code.text(jsonObj[i]["api_code"]).appendTo(tr);

                    var api_name = $("<td></td>");
                    api_name.text(jsonObj[i]["api_name"]).appendTo(tr);

                    var api_group = $("<td></td>");
                    api_group.text(jsonObj[i]["group_name"]).appendTo(tr);

                    var api_descr = $("<td></td>");
                    api_descr.text(jsonObj[i]["descr"]).appendTo(tr);

                    var btn_td = $("<td></td>");
                    var btn_div = $("<div></div>");
                    btn_div.attr({ "class": "btn btn-info btn-sm", "id": jsonObj[i]["api_code"] }).text("详情").appendTo(tr);
                    btn_div.click(function () { 
                        cli_api_info($(this).attr("id"));
                    });
                }
             }
        }

        function cli_api_info(api_code) { 
            //alert(api_code);
            $.ajax({
                url: "/Index/ApiInfo",
                type: "post",
                cache: false,
                data: {
                    "api_code": api_code
                },
                success: function (data) {
                    $("#content_body").html(data);
                }
            });
        }
    </script>
</body>
</html>
